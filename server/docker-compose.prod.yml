version: '3.8'

# 使用GitHub Container Registry镜像的生产环境配置
# 使用前请确保已通过GitHub登录认证:
# docker login ghcr.io -u your-username -p your-token
services:
  cookie-manager-server:
    # GitHub Container Registry镜像
    image: ghcr.io/dyyz1993/cookie-manager-server:latest
    container_name: cookie-manager-server
    ports:
      - "5000:5000"
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    environment:
      - FLASK_ENV=production
      - DATABASE_PATH=/app/data/database.db
      - MAX_DATA_SIZE=1048576  # 1MB
      - ADMIN_PASSWORD=secure123
      - MAX_VERSIONS=10
      - LOG_LEVEL=INFO
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "--max-time", "5", "http://localhost:5000/health"]
      interval: 30s
      timeout: 15s
      retries: 3
      start_period: 60s